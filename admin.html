<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8">
<title>Admin Presensi</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<style>
:root{
  --primary:#2563eb;
  --danger:#ef4444;
  --text:#0f172a;
  --muted:#64748b;
}
*{margin:0;padding:0;box-sizing:border-box;font-family:'Inter','Segoe UI',Arial,sans-serif}
body{
  min-height:100vh;
  background:linear-gradient(135deg,#eef2ff,#f8fafc);
  display:flex;justify-content:center;align-items:flex-start;
  overflow-y:auto;padding:20px 0
}
canvas{position:fixed;inset:0;z-index:0}
.card{
  position:relative;z-index:1;
  width:100%;max-width:420px;
  padding:28px 26px;border-radius:20px;
  background:rgba(255,255,255,.88);
  backdrop-filter:blur(14px);
  box-shadow:0 20px 40px rgba(15,23,42,.12)
}
h3{text-align:center;font-size:16px;font-weight:700;margin-bottom:18px}
label{font-size:12px;font-weight:600;color:var(--muted)}
input,select{
  width:100%;padding:12px;margin:6px 0 14px;
  border-radius:12px;border:1px solid #e2e8f0;font-size:14px
}
button{
  width:100%;padding:14px;border:none;border-radius:14px;
  font-size:14px;font-weight:700;cursor:pointer
}
.btn-primary{background:linear-gradient(135deg,#2563eb,#1d4ed8);color:#fff}
.btn-danger{margin-top:10px;background:#fee2e2;color:#991b1b}
.btn-ghost{margin-top:10px;background:#e2e8f0}
.login{display:block}
.admin{display:none}
small{display:block;margin-top:12px;font-size:11px;color:var(--muted);text-align:center}
</style>
</head>

<body>

<canvas id="bg"></canvas>

<div class="card">

<!-- LOGIN -->
<div class="login" id="loginBox">
  <h3>LOGIN ADMIN</h3>
  <label>Password</label>
  <input type="password" id="pwd">
  <button class="btn-primary" onclick="login()">Masuk</button>
  <small>Product By <b>SyarifProject</b></small>
</div>

<!-- ADMIN -->
<div class="admin" id="adminBox">
  <h3>ADMIN PRESENSI</h3>

  <label>Pilih Mata Kuliah</label>
  <select id="matkulSelect"></select>

  <label>Nama Mata Kuliah</label>
  <input id="namaMatkul">

  <label>Dosen Pengampu</label>
  <input id="dosen">

  <label>Pertemuan</label>
  <input id="pertemuan" type="number" min="1">

  <button class="btn-primary" onclick="simpan()">Simpan Perubahan</button>
  <button class="btn-danger" onclick="resetPertemuan()">Reset Pertemuan ke 1</button>
  <button class="btn-ghost" onclick="logout()">Keluar</button>

  <small>*Perubahan langsung berlaku di kelas & absensi</small>
</div>

</div>

<script>
/* ===== PASSWORD ===== */
const ADMIN_PASSWORD = "syarif2005";

/* ===== LOGIN ===== */
function login(){
  if(pwd.value === ADMIN_PASSWORD){
    loginBox.style.display="none";
    adminBox.style.display="block";
    init();
  } else alert("Password salah");
}
function logout(){
  adminBox.style.display="none";
  loginBox.style.display="block";
}

/* ===== DATA MATKUL (SET SEKALI SAJA) ===== */
const DEFAULT_MATKUL = [
 { nama:"Pembelajaran Akidah Akhlak", dosen:"Tahrir Rosadi, M.Pd" },
 { nama:"Pembelajaran Fiqih", dosen:"Devi Yaniar Wi Hargina, M.Pd.I" },
 { nama:"Pengembangan Media dan Sumber Belajar PAI", dosen:"Nurhidayah, M.Pd" },
 { nama:"Bimbingan Konseling Peserta Didik", dosen:"Maesaroh, M.Ag" },
 { nama:"Pembelajaran SKI", dosen:"Atsmarina Awanis, M.Pd" },
 { nama:"Pembelajaran Qurâ€™an Hadis", dosen:"Mustajab, M.Pd" },
 { nama:"Strategi Pembelajaran PAI", dosen:"Fibriyan Irodati, M.Pd.I" },
 { nama:"Psikologi Pendidikan", dosen:"Syukron Makmun, M.Pd" },
 { nama:"Evaluasi Pembelajaran PAI", dosen:"Dr. Imam Subarkah, M.Pd" }
];

if(!localStorage.getItem("daftarMatkul")){
  localStorage.setItem("daftarMatkul", JSON.stringify(DEFAULT_MATKUL));
}

let daftarMatkul = JSON.parse(localStorage.getItem("daftarMatkul"));
const select = document.getElementById("matkulSelect");

/* ===== INIT ===== */
function init(){
  select.innerHTML="";
  daftarMatkul.forEach((m,i)=>{
    const opt=document.createElement("option");
    opt.value=i; opt.textContent=m.nama; select.appendChild(opt);
    const k="pertemuan_"+m.nama;
    if(!localStorage.getItem(k)) localStorage.setItem(k,1);
  });
  load();
}

/* ===== LOAD ===== */
function load(){
  const m = daftarMatkul[select.value];
  namaMatkul.value = m.nama;
  dosen.value = m.dosen;
  pertemuan.value = localStorage.getItem("pertemuan_"+m.nama);
}
select.onchange = load;

/* ===== SIMPAN ===== */
function simpan(){
  const idx = select.value;
  const lama = daftarMatkul[idx].nama;
  const baru = namaMatkul.value.trim();
  const dos  = dosen.value.trim();
  const pt   = Number(pertemuan.value);

  if(!baru || !dos || pt < 1) return alert("Lengkapi data");

  const oldKey="pertemuan_"+lama;
  const newKey="pertemuan_"+baru;
  const oldPt=localStorage.getItem(oldKey);

  if(lama !== baru){
    localStorage.removeItem(oldKey);
    localStorage.setItem(newKey, oldPt || pt);
  } else {
    localStorage.setItem(oldKey, pt);
  }

  daftarMatkul[idx] = { nama:baru, dosen:dos };
  localStorage.setItem("daftarMatkul", JSON.stringify(daftarMatkul));

  /* ðŸ”¥ SINKRON KE SEMUA HALAMAN */
  localStorage.setItem("matkulAktif", baru);
  localStorage.setItem("dosenAktif", dos);
  localStorage.setItem("pertemuan_"+baru, pt);

  alert("Perubahan berhasil disimpan");
  init(); select.value=idx; load();
}

/* ===== RESET ===== */
function resetPertemuan(){
  const m = daftarMatkul[select.value].nama;
  if(confirm(`Reset pertemuan ${m} ke 1?`)){
    localStorage.setItem("pertemuan_"+m,1);
    pertemuan.value=1;
  }
}

/* ===== BACKGROUND ===== */
const c=document.getElementById("bg"),x=c.getContext("2d");
let w,h;function r(){w=c.width=innerWidth;h=c.height=innerHeight}
addEventListener("resize",r);r();
let d=[...Array(70)].map(()=>({x:Math.random()*w,y:Math.random()*h,vx:(Math.random()-.5)*.4,vy:(Math.random()-.5)*.4}));
(function a(){
 x.clearRect(0,0,w,h);
 d.forEach((p,i)=>{
  p.x+=p.vx;p.y+=p.vy;
  if(p.x<0||p.x>w)p.vx*=-1;if(p.y<0||p.y>h)p.vy*=-1;
  x.beginPath();x.arc(p.x,p.y,2,0,7);x.fillStyle="#c7d2fe";x.fill();
  d.slice(i+1).forEach(q=>{
    let l=Math.hypot(p.x-q.x,p.y-q.y);
    if(l<120){
      x.beginPath();x.moveTo(p.x,p.y);x.lineTo(q.x,q.y);
      x.strokeStyle="rgba(199,210,254,.35)";
      x.stroke()
    }
  });
 });
 requestAnimationFrame(a);
})();
</script>

</body>
</html>
